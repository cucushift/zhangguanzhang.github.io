<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Zhangguanzhang">
  <!-- Open Graph Data -->
  <meta property="og:title" content="服务器上mqtt的客户端与server端mosquitto的安装和使用"/>
  <meta property="og:description" content="记录生活点滴" />
  <meta property="og:site_name" content="Zhangguanzhang"/>
  <meta property="og:type" content="article" />
  <meta property="og:image" content="http://zhangguanzhang.github.ioundefined"/>
  <meta name="baidu-site-verification" content="RqbanSZBE3" />
  
    <link rel="alternate" href="/atom.xml" title="Zhangguanzhang" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>Zhangguanzhang</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/css/style.dark.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/img/default-banner-dark.jpg)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">服务器上mqtt的客户端与server端mosquitto的安装和使用</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/zhangguanzhang">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:zhangguanzhang@qq.com">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By Zhangguanzhang</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2017-02-25</span>
            <span class="time">09:39:24</span>
          </span>
          
          <!--  Categories  -->
            <span class="categories info">Under 

<a href="/categories/日志/">日志</a> / <a href="/categories/日志/心得/">心得</a>
</span>
          
        </div>
        <!-- Tags -->
        
          <div class="post-tags text-muted">
            Tags: 

<a class="tag" href="/tags/mqtt/">#mqtt</a> <a class="tag" href="/tags/原创/">#原创</a>


          </div>
        
        <!-- Post Main Content -->
        <div class="post-content">
          <p>昨天看了一些教程总结了下<br><a id="more"></a></p>
<h3 id="废话不多说开始"><a href="#废话不多说开始" class="headerlink" title="废话不多说开始"></a>废话不多说开始</h3><p>我服务器用的centos6.5<br>安装基本依赖</p>
<pre><code>yum install cmake gcc-c++ openssl-devel  c-ares-devel</code></pre>

<p>我下载的1.4.5,因为我是只用客户端来接收消息,没必要那么高</p>
<p><pre><code>wget <a href="http://mosquitto.org/files/source/mosquitto-1.4.5.tar.gz" target="_blank" rel="external">http://mosquitto.org/files/source/mosquitto-1.4.5.tar.gz</a><br>tar zxfv mosquitto-1.4.5.tar.gz<br>cd mosquitto-1.4.5.tar.gz<br>cmake .<br>make<br>make install</code></pre><br><img src="http://p1.bpimg.com/4851/10731e924769f5da.png" alt="install"><br><br><br><span style="font-size: 18px;color: blue">推送和订阅的话使用mosquitto_pub和mosquitto_sub<br>只列出了一些参数,完整的话可以man下这俩命令看看手册就知道了<br></span><br>mosquitto_pub 命令参数说明</p>
<ol>
<li><p>-d  打印debug信息</p>
</li>
<li><p>-f  将指定文件的内容作为发送消息的内容</p>
</li>
<li><p>-h  指定要连接的域名  默认为localhost</p>
</li>
<li><p>-i  指定要给哪个clientId的用户发送消息</p>
</li>
<li><p>-I  指定给哪个clientId前缀的用户发送消息</p>
</li>
<li><p>-m  消息内容</p>
</li>
<li><p>-n  发送一个空（null）消息</p>
</li>
<li><p>-p  连接端口号</p>
</li>
<li><p>-q  指定QoS的值（0,1,2）</p>
</li>
<li><p>-t  指定topic</p>
</li>
<li><p>-u  指定broker访问用户</p>
</li>
<li><p>-P  指定broker访问密码</p>
</li>
<li><p>-V  指定MQTT协议版本</p>
</li>
<li><p>–will-payload  指定一个消息，该消息当客户端与broker意外断开连接时发出。该参数需要与–will-topic一起使用</p>
</li>
<li><p>–will-qos  Will的QoS值。该参数需要与–will-topic一起使用</p>
</li>
<li><p>–will-retain 指定Will消息被当做一个retain消息（即消息被广播后，该消息被保留起来）。该参数需要与–will-topic一起使用</p>
</li>
<li><p>–will-topic  用户发送Will消息的topic</p>
</li>
</ol>
<p><hr><br>mosquitto_sub 命令参数说明</p>
<ol>
<li><p>-a  将出站连接绑定到本地ip地址/主机名。 如果你使用这个参数,需要限制网络通信到特定接口。</p>
</li>
<li><p>-c  设定‘clean session’为无效状态，这样一直保持订阅状态，即便是已经失去连接，如果再次连接仍旧能够接收的断开期间发送的消息。</p>
</li>
<li><p>-C 在给定的消息计数之后立即断开并退出程序,这在单个状态值为的shell脚本中可能很有用</p>
</li>
<li><p>-d  打印debug信息</p>
</li>
<li><p>-h  指定要连接的域名  默认为localhost</p>
</li>
<li><p>-i 指定clientId</p>
</li>
<li><p>-I 指定clientId前缀</p>
</li>
<li><p>-k keepalive 每隔一段时间，发PING消息通知broker，仍处于连接状态。 默认为60秒。</p>
</li>
<li><p>-p 连接端口,来替代默认的1803</p>
</li>
<li><p>-P 连接时指定用户名,与-u一起使用,用于要链接的server端开启了用户名和密码验证</p>
</li>
<li><p>-q 指定希望接收到QoS为什么的消息  默认QoS为0</p>
</li>
<li><p>-R 不显示陈旧的消息</p>
</li>
<li><p>-t 订阅topic</p>
</li>
<li><p>-u 连接时用户名</p>
</li>
<li><p>-v 打印消息</p>
</li>
<li><p>–will-payload  指定一个消息，该消息当客户端与broker意外断开连接时发出。该参数需要与–will-topic一起使用</p>
</li>
<li><p>–will-qos  Will的QoS值。该参数需要与–will-topic一起使用</p>
</li>
<li><p>–will-retain 指定Will消息被当做一个retain消息（即消息被广播后，该消息被保留起来）。该参数需要与–will-topic一起使用</p>
</li>
<li><p>–will-topic  用户发送Will消息的topic</p>
</li>
</ol>

        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        <p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

